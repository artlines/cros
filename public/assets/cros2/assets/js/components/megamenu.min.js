(function($){'use strict';function Sub2Menu(element,options){var self=this;this.$element=$(element);this.options=$.extend(!0,{},Sub2Menu.defaults,options);this._items=$();Object.defineProperties(this,{itemsSelector:{get:function(){return self.options.classMap.hasSubMenu+','+self.options.classMap.hasSub2Menu}},_tempChain:{value:null,writable:!0},state:{value:null,writable:!0}});this.initialize()};Sub2Menu.defaults={event:'hover',direction:'horizontal',breakpoint:991,animationIn:!1,animationOut:!1,rtl:!1,hideTimeOut:300,sideBarRatio:1/4,pageContainer:$('body'),classMap:{initialized:'.cs-menu-initialized',mobileState:'.cs-mobile-state',subMenu:'.cs-sub-menu',hasSubMenu:'.cs-has-sub-menu',hasSubMenuActive:'.cs-sub-menu-opened',Sub2Menu:'.cs-mega-menu',hasSub2Menu:'.cs-has-mega-menu',hasSub2MenuActive:'.cs-mega-menu-opened'},mobileSpeed:400,mobileEasing:'linear',beforeOpen:function(){},beforeClose:function(){},afterOpen:function(){},afterClose:function(){}};Sub2Menu.prototype.initialize=function(){var self=this,$w=$(window);if(this.options.rtl)this.$element.addClass('cs-rtl');this.$element.addClass(this.options.classMap.initialized.slice(1)).addClass('cs-menu-'+this.options.direction);$w.on('resize.SubMenu',function(e){if(self.resizeTimeOutId)clearTimeout(self.resizeTimeOutId);self.resizeTimeOutId=setTimeout(function(){if($w.width()<=self.options.breakpoint&&self.state=='desktop')self.initMobileBehavior();else if($w.width()>self.options.breakpoint&&self.state=='mobile')self.initDesktopBehavior();self.refresh()},50)});$(document).on('click.SubMenu',function(e){var $parents=$(e.target).parents(self.itemsSelector);self.closeAll($parents.add($(e.target)))}).on('keyup.SubMenu',function(e){if(e.keyCode&&e.keyCode==27)self.closeAll()});if($w.width()<=this.options.breakpoint)this.initMobileBehavior();else if($w.width()>this.options.breakpoint)this.initDesktopBehavior();this.smartPositions();return this};Sub2Menu.prototype.smartPositions=function(){var self=this,$submenus=this.$element.find(this.options.classMap.subMenu);$submenus.each(function(i,el){MenuItem.smartPosition($(el),self.options)})};Sub2Menu.prototype.bindEvents=function(){var self=this,selector;if(this.options.event==='hover'&&!_isTouch()){this.$element.on('mouseenter.SubMenu',this.options.classMap.hasSub2Menu+':not([data-event="click"]),'+this.options.classMap.hasSubMenu+':not([data-event="click"])',function(e){var $this=$(this),$chain=$this.parents(self.itemsSelector);if(!$this.data('HSMenuItem')){self.initMenuItem($this,self.getType($this))}
$chain=$chain.add($this);self.closeAll($chain);$chain.each(function(i,el){var HSMenuItem=$(el).data('HSMenuItem');if(HSMenuItem.hideTimeOutId)clearTimeout(HSMenuItem.hideTimeOutId);HSMenuItem.show()});self._items=self._items.not($chain);self._tempChain=$chain;e.preventDefault();e.stopPropagation()}).on('mouseleave.SubMenu',this.options.classMap.hasSub2Menu+':not([data-event="click"]),'+this.options.classMap.hasSubMenu+':not([data-event="click"])',function(e){var $this=$(this),HSMenuItem=$this.data('HSMenuItem'),$chain=$(e.relatedTarget).parents(self.itemsSelector);HSMenuItem.hideTimeOutId=setTimeout(function(){self.closeAll($chain)},self.options.hideTimeOut);self._items=self._items.add(self._tempChain);self._tempChain=null;e.preventDefault();e.stopPropagation()}).on('click.SubMenu',this.options.classMap.hasSub2Menu+'[data-event="click"] > a, '+this.options.classMap.hasSubMenu+'[data-event="click"] > a',function(e){var $this=$(this).parent('[data-event="click"]'),HSMenuItem;if(!$this.data('HSMenuItem')){self.initMenuItem($this,self.getType($this))}
self.closeAll($this.add($this.parents(self.itemsSelector)));HSMenuItem=$this.data('HSMenuItem');if(HSMenuItem.isOpened){HSMenuItem.hide()}else{HSMenuItem.show()}
e.preventDefault();e.stopPropagation()})}else{this.$element.on('click.SubMenu',(_isTouch()?this.options.classMap.hasSub2Menu+' > a, '+this.options.classMap.hasSubMenu+' > a':this.options.classMap.hasSub2Menu+':not([data-event="hover"]) > a,'+this.options.classMap.hasSubMenu+':not([data-event="hover"]) > a'),function(e){var $this=$(this).parent(),HSMenuItem,$parents=$this.parents(self.itemsSelector);if(!$this.data('HSMenuItem')){self.initMenuItem($this,self.getType($this))}
self.closeAll($this.add($this.parents(self.itemsSelector)));HSMenuItem=$this.addClass('cs-event-prevented').data('HSMenuItem');if(HSMenuItem.isOpened){HSMenuItem.hide()}else{HSMenuItem.show()}
e.preventDefault();e.stopPropagation()});if(!_isTouch()){this.$element.on('mouseenter.SubMenu',this.options.classMap.hasSub2Menu+'[data-event="hover"],'+this.options.classMap.hasSubMenu+'[data-event="hover"]',function(e){var $this=$(this),$parents=$this.parents(self.itemsSelector);if(!$this.data('HSMenuItem')){self.initMenuItem($this,self.getType($this))}
self.closeAll($this.add($parents));$parents.add($this).each(function(i,el){var HSMenuItem=$(el).data('HSMenuItem');if(HSMenuItem.hideTimeOutId)clearTimeout(HSMenuItem.hideTimeOutId);HSMenuItem.show()});e.preventDefault();e.stopPropagation()}).on('mouseleave.SubMenu',this.options.classMap.hasSub2Menu+'[data-event="hover"],'+this.options.classMap.hasSubMenu+'[data-event="hover"]',function(e){var $this=$(this),HSMenuItem=$this.data('HSMenuItem');HSMenuItem.hideTimeOutId=setTimeout(function(){self.closeAll($(e.relatedTarget).parents(self.itemsSelector))},self.options.hideTimeOut);e.preventDefault();e.stopPropagation()})}}};Sub2Menu.prototype.initMenuItem=function(element,type){var self=this,Item=new MenuItem(element,element.children(self.options.classMap[type==='mega-menu'?'Sub2Menu':'subMenu']),$.extend(!0,{type:type},self.options,element.data()),self.$element);element.data('HSMenuItem',Item);this._items=this._items.add(element)};Sub2Menu.prototype.initMobileBehavior=function(){var self=this;this.state='mobile';this.$element.off('.SubMenu').addClass(this.options.classMap.mobileState.slice(1)).on('click.SubMenu',self.options.classMap.hasSubMenu+' > a, '+self.options.classMap.hasSub2Menu+' > a',function(e){var $this=$(this).parent(),MenuItemInstance;if(!$this.data('HSMenuItem')){self.initMenuItem($this,self.getType($this))}
self.closeAll($this.parents(self.itemsSelector).add($this));MenuItemInstance=$this.data('HSMenuItem');console.log(MenuItemInstance.isOpened);if(MenuItemInstance.isOpened){MenuItemInstance.mobileHide()}else{MenuItemInstance.mobileShow()}
e.preventDefault();e.stopPropagation()}).find(this.itemsSelector).not(this.options.classMap.hasSubMenuActive+','+this.options.classMap.hasSub2MenuActive).children(this.options.classMap.subMenu+','+this.options.classMap.Sub2Menu).hide()};Sub2Menu.prototype.initDesktopBehavior=function(){this.state='desktop';this.$element.removeClass(this.options.classMap.mobileState.slice(1)).off('.SubMenu').find(this.itemsSelector).not(this.options.classMap.hasSubMenuActive+','+this.options.classMap.hasSub2MenuActive).children(this.options.classMap.subMenu+','+this.options.classMap.Sub2Menu).hide();this.bindEvents()};Sub2Menu.prototype.closeAll=function(except){var self=this;return this._items.not(except&&except.length?except:$()).each(function(i,el){$(el).removeClass('cs-event-prevented').data('HSMenuItem')[self.state=='mobile'?'mobileHide':'hide']()})};Sub2Menu.prototype.getType=function(item){if(!item||!item.length)return null;return item.hasClass(this.options.classMap.hasSubMenu.slice(1))?'sub-menu':(item.hasClass(this.options.classMap.hasSub2Menu.slice(1))?'mega-menu':null)};Sub2Menu.prototype.getState=function(){return this.state};Sub2Menu.prototype.refresh=function(){return this._items.add(this._tempChain).each(function(i,el){$(el).data('HSMenuItem')._updateMenuBounds()})};function MenuItem(element,menu,options,container){var self=this;this.$element=element;this.menu=menu;this.options=options;this.$container=container;Object.defineProperties(this,{itemClass:{get:function(){return self.options.type==='mega-menu'?self.options.classMap.hasSub2Menu:self.options.classMap.hasSubMenu}},activeItemClass:{get:function(){return self.options.type==='mega-menu'?self.options.classMap.hasSub2MenuActive:self.options.classMap.hasSubMenuActive}},menuClass:{get:function(){return self.options.type==='mega-menu'?self.options.classMap.Sub2Menu:self.options.classMap.subMenu}},isOpened:{get:function(){return this.$element.hasClass(this.activeItemClass.slice(1))}}});this.menu.addClass('animated').on('click.SubMenu',function(e){self._updateMenuBounds()});if(this.$element.data('max-width'))this.menu.css('max-width',this.$element.data('max-width'));if(this.$element.data('position'))this.menu.addClass('cs-position-'+this.$element.data('position'));if(this.options.animationOut){this.menu.on('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend',function(e){if(self.menu.hasClass(self.options.animationOut)){self.$element.removeClass(self.activeItemClass.slice(1));self.options.afterClose.call(self,self.$element,self.menu)}
if(self.menu.hasClass(self.options.animationIn)){self.options.afterOpen.call(self,self.$element,self.menu)}
e.stopPropagation();e.preventDefault()})}}
MenuItem.prototype.show=function(){if(!this.menu.length)return this;this.$element.addClass(this.activeItemClass.slice(1));if(this.options.direction=='horizontal')this.smartPosition(this.menu,this.options);this._updateMenuBounds();if(this.options.animationOut){this.menu.removeClass(this.options.animationOut)}else{this.options.afterOpen.call(this,this.$element,this.menu)}
if(this.options.animationIn)this.menu.addClass(this.options.animationIn);return this}
MenuItem.prototype.hide=function(){var self=this;if(!this.menu.length)return this;if(!this.options.animationOut){this.$element.removeClass(this.activeItemClass.slice(1))}
if(this.options.animationIn)this.menu.removeClass(this.options.animationIn);if(this.options.animationOut){this.menu.addClass(this.options.animationOut)}else{this.options.afterClose.call(this,this.$element,this.menu)}
return this}
MenuItem.prototype.mobileShow=function(){var self=this;if(!this.menu.length)return this;this.menu.removeClass(this.options.animationIn).removeClass(this.options.animationOut).stop().slideDown({duration:self.options.mobileSpeed,easing:self.options.mobileEasing,complete:function(){self.options.afterOpen.call(self,self.$element,self.menu)}});this.$element.addClass(this.activeItemClass.slice(1));return this};MenuItem.prototype.mobileHide=function(){var self=this;if(!this.menu.length)return this;this.menu.stop().slideUp({duration:self.options.mobileSpeed,easing:self.options.mobileEasing,complete:function(){self.options.afterClose.call(self,self.$element,self.menu)}});this.$element.removeClass(this.activeItemClass.slice(1));return this};MenuItem.prototype.smartPosition=function(element,options){MenuItem.smartPosition(element,options)};MenuItem.smartPosition=function(element,options){if(!element&&!element.length)return;var $w=$(window);element.removeClass('cs-reversed');if(!options.rtl){if(element.offset().left+element.outerWidth()>$w.width()){element.addClass('cs-reversed')}}else{if(element.offset().left<0){element.addClass('cs-reversed')}}};MenuItem.prototype._updateMenuBounds=function(){var width='auto';if(this.options.direction=='vertical'&&this.options.type=='mega-menu'){if(this.$container&&this.$container.data('SubMenu').getState()=='desktop'){if(!this.options.pageContainer.length)this.options.pageContainer=$('body');width=this.options.pageContainer.outerWidth()*(1-this.options.sideBarRatio)}else{width='auto'}
this.menu.css({'width':width,'height':'auto'});if(this.menu.outerHeight()>this.$container.outerHeight()){return}
this.menu.css('height','100%')}};$.fn.SubMenu=function(options){return this.each(function(i,el){var $this=$(this);if(!$this.data('SubMenu')){$this.data('SubMenu',new Sub2Menu($this,options))}})};function _isTouch(){return('ontouchstart' in window)}})(jQuery)